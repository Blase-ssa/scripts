Dim fhostDim fnameDim fpassSet wshShell = WScript.CreateObject ("WSCript.shell")Dim bPasswordBoxWait ' A required global variable str = PasswordBox("введите имя сервера и ваши учётные данные") Function PasswordBox(sTitle)   set oIE = CreateObject("InternetExplorer.Application")   With oIE     .FullScreen = False     .ToolBar   = False : .RegisterAsDropTarget = False     .StatusBar = False : .Navigate("about:blank")     While .Busy : WScript.Sleep 100 : Wend     With .document       With .ParentWindow         .resizeto 400,300         .moveto .screen.width/2-200, .screen.height/2-50       End With       .WriteLn("<html><head>")       .WriteLn("<title>" & sTitle & "</title>")       .WriteLn("</head><body bgColor=Silver><center><table>") 	  .WriteLn("<tr><td>Имя/IP сервера: \\</td><td><input type=text id=fhost></td></tr>" )	  .WriteLn("<tr><td>Логин: 			</td><td><input type=text id=flogin></td></tr>" )      .WriteLn("<tr><td>Пароль:			</td><td><input type=password id=fpass> </td></tr> <tr><td> <button id=but0>Submit</button></td><td>  </td></tr> ")       .WriteLn("<tr><td colspan=2> 1)прежде чем заходить на SMB ресурс убедитесь что у вас нет открытых окон с этим ресурсом<br>2) Внимание: при подключении сначала проходит удаление записи о подключении к этому серверу, и только потом создаётся новое   </td></tr> " )	  .WriteLn("<table></center> </body></html>")       With .ParentWindow.document.body         .scroll="no"         .style.borderStyle = "outset"         .style.borderWidth = "3px"       End With       .all.but0.onclick = getref("PasswordBox_Submit")       .all.fhost.focus 	  .all.flogin.focus 	  .all.fpass.focus       oIE.Visible = True       bPasswordBoxOkay = False : bPasswordBoxWait = True       On Error Resume Next       While bPasswordBoxWait         WScript.Sleep 100         if oIE.Visible Then bPasswordBoxWait = bPasswordBoxWait         if Err Then bPasswordBoxWait = False       Wend       PasswordBox = "serv_name " & .all.fhost.value & " usr_login " & .all.flogin.value & " usr_pass " & .all.fpass.value    End With ' document     .Visible = False   End With   ' IE End Function Sub PasswordBox_Submit()   bPasswordBoxWait = False End Subresult = Split(str)size = UBound (result)if size < 5 then 	msgbox "не все поля заполнены либо заполнены не верно"	WScript.quit end iffor i = 0 to size	if (result(i) = "serv_name") then		if(result(i+1) = "") then			msgbox "вы не ввели адрес сервера для подключения"			WScript.quit		else 			host_name=result(i+1)		end if		i=i+2	else		msgbox "во время выполнения скрипта произошла ошибка"		WScript.quit	end if	if (result(i) = "usr_login") then		if(result(i+1) = "") then			msgbox "вы не ввели имя учётной записи"			WScript.quit		else 			usr_name=result(i+1)		end if		i=i+2	else		msgbox "во время выполнения скрипта произошла ошибка"		WScript.quit	end if	if (result(i) = "usr_pass") then		if(result(i+1) = "") then			msgbox "вы не ввели пароль"			WScript.quit		else 			usr_pass=result(i+1)		end if		i=i+2	else		msgbox "во время выполнения скрипта произошла ошибка"		WScript.quit	end ifnext 'msgbox "cmd /c net use \\" & host_name & " /DELETE" & Chr(13) & Chr(10) & "cmd /c net use \\" & host_name & " /USER:" & usr_name & " " & usr_pass & Chr(13) & Chr(10) & "\\" & host_name & "\"wshshell.run "cmd /c net use \\" & host_name & " /DELETE", 0, Truewshshell.run "cmd /c net use \\" & host_name & " /USER:" & usr_name & " " & usr_pass, 0, TruewshShell.run "\\" & host_name & "\", 1, false